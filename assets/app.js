angular.module("app",["ngRoute"]),angular.module("app").controller("ApplicationCtrl",["$scope","$location","$window","UserSvc",function(e,t,n,o){if(e.$on("login",function(n,o){e.currentUser=o,t.path("/")}),e.logout=function(){delete e.currentUser,t.path("/"),window.sessionStorage.removeItem("token")},o.isLoggedIn()){o.getUser().then(function(t){e.currentUser=t})}}]),angular.module("app").controller("AskCtrl",["$scope","QuestSvc",function(e,t){e.addQuestion=function(){e.postBody&&t.create({username:e.currentUser.username,body:e.postBody}).success(function(t){e.questions.unshift(t),e.postBody=null})},t.fetch().success(function(t){e.questions=t})}]),angular.module("app").controller("LoginCtrl",["$scope","UserSvc",function(e,t){e.login=function(n,o){e.errorMsg="",t.login(n,o).then(function(t){e.$emit("login",t)},function(){e.errorMsg="Incorrect username/password."})}}]),angular.module("app").controller("QuestCtrl",["$scope","QuestSvc","$location",function(e,t,n){e.addQuestion=function(){e.postBody&&t.create({username:e.currentUser.username,title:e.title,body:e.postBody,answersCount:0,upvote:0,downvote:0}).success(function(t){e.questions.unshift(t),e.postBody=null,n.path("/")})},e.askQuestionView=function(){n.path("/ask")},t.fetch().success(function(t){e.questions=t}),e.getQuestionById=function(n){t.fetchById(n).then(function(t){e.quest=t})}}]),angular.module("app").service("QuestSvc",["$http",function(e){this.fetch=function(){return e.get("/api/questions")},this.fetchById=function(t){return e.get("/api/questions/"+t)},this.create=function(t){return e.post("/api/questions",t)}}]),angular.module("app").controller("RegisterCtrl",["$scope","UserSvc",function(e,t){e.register=function(n,o){t.register(n,o).then(function(t){e.$emit("login",t)})}}]),angular.module("app").config(["$routeProvider",function(e){e.when("/",{controller:"QuestCtrl",templateUrl:"/templates/questions.html"}).when("/register",{controller:"RegisterCtrl",templateUrl:"/templates/register.html"}).when("/login",{controller:"LoginCtrl",templateUrl:"/templates/login.html"}).when("/ask",{controller:"QuestCtrl",templateUrl:"/templates/ask.html"}).when("/questions/:questId",{controller:"SingleQuestCtrl",templateUrl:"/templates/quest.html"})}]),angular.module("app").controller("SingleQuestCtrl",["$scope","$routeParams","SingleQuestSvc","$location",function(e,t,n){n.fetchById(t.questId).then(function(t){e.quest=t.data}),e.addAnswer=function(){n.postAnswer({username:e.currentUser.username,questionId:t.questId,body:e.answerBody}).then(function(){})},n.fetchAnswers(t.questId).then(function(t){e.answers=t.data})}]),angular.module("app").service("SingleQuestSvc",["$http",function(e){this.fetchById=function(t){return e.get("/api/questions/"+t)},this.postAnswer=function(t){return e.post("/api/questions/answer",t)},this.fetchAnswers=function(t){return e.get("/api/questions/answer/"+t)}}]),angular.module("app").service("UserSvc",["$http",function(e){var t=this;t.getUser=function(){return e.get("/api/users").then(function(e){return e.data})},t.login=function(n,o){return e.post("/api/sessions",{username:n,password:o}).then(function(n){return window.sessionStorage.token=n.data,e.defaults.headers.common["x-auth"]=n.data,t.getUser()})},t.register=function(n,o){return e.post("/api/users",{username:n,password:o}).then(function(){return t.login(n,o)})},t.isLoggedIn=function(){var t=!1;return window.sessionStorage.token&&(e.defaults.headers.common["x-auth"]=window.sessionStorage.token,t=!0),t}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsImFwcGxpY2F0aW9uLmN0cmwuanMiLCJhc2suY3RybC5qcyIsImxvZ2luLmN0cmwuanMiLCJxdWVzdC5jdHJsLmpzIiwicXVlc3Quc3ZjLmpzIiwicmVnaXN0ZXIuY3RybC5qcyIsInJvdXRlcy5qcyIsInNpbmdsZXF1ZXN0LmN0cmwuanMiLCJzaW5nbGVxdWVzdC5zdmMuanMiLCJ1c2VyLnN2Yy5qcyJdLCJuYW1lcyI6WyJhbmd1bGFyIiwibW9kdWxlIiwiY29udHJvbGxlciIsIiRzY29wZSIsIiRsb2NhdGlvbiIsIiR3aW5kb3ciLCJVc2VyU3ZjIiwiJG9uIiwiXyIsInVzZXIiLCJjdXJyZW50VXNlciIsInBhdGgiLCJsb2dvdXQiLCJ3aW5kb3ciLCJzZXNzaW9uU3RvcmFnZSIsInJlbW92ZUl0ZW0iLCJpc0xvZ2dlZEluIiwiZ2V0VXNlciIsInRoZW4iLCJyZXNwb25zZSIsIlF1ZXN0U3ZjIiwiYWRkUXVlc3Rpb24iLCJwb3N0Qm9keSIsImNyZWF0ZSIsInVzZXJuYW1lIiwiYm9keSIsInN1Y2Nlc3MiLCJxdWVzdGlvbiIsInF1ZXN0aW9ucyIsInVuc2hpZnQiLCJmZXRjaCIsImxvZ2luIiwicGFzc3dvcmQiLCJlcnJvck1zZyIsIiRlbWl0IiwidGl0bGUiLCJhbnN3ZXJzQ291bnQiLCJ1cHZvdGUiLCJkb3dudm90ZSIsImFza1F1ZXN0aW9uVmlldyIsImdldFF1ZXN0aW9uQnlJZCIsImlkIiwiZmV0Y2hCeUlkIiwicXVlc3QiLCJzZXJ2aWNlIiwiJGh0dHAiLCJ0aGlzIiwiZ2V0IiwicG9zdCIsInJlZ2lzdGVyIiwiY29uZmlnIiwiJHJvdXRlUHJvdmlkZXIiLCJ3aGVuIiwidGVtcGxhdGVVcmwiLCIkcm91dGVQYXJhbXMiLCJTaW5nbGVRdWVzdFN2YyIsInF1ZXN0SWQiLCJkYXRhIiwiYWRkQW5zd2VyIiwicG9zdEFuc3dlciIsInF1ZXN0aW9uSWQiLCJhbnN3ZXJCb2R5IiwiZmV0Y2hBbnN3ZXJzIiwiYW5zd2VycyIsImFuc3dl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QUFBL0MsRUFBQXNDLEtBQ0FaLEVBQUFzQixTQUFBQyxRQUFBQyxPQUFBLFVBQUFsRCxFQUFBc0MsS0FDQVEsRUFBQWhELGFBR0pnRCxFQUFBaEIsU0FBQSxTQUFBekIsRUFBQVEsR0FDRSxNQUFBYSxHQUFBRyxLQUFBLGNBQ0V4QixTQUFBQSxFQUFBUSxTQUFBQSxJQUNGZCxLQUFBLFdBQ0UsTUFBQStDLEdBQUFsQyxNQUFBUCxFQUFBUSxNQUdKaUMsRUFBQWpELFdBQUEsV0FDRSxHQUFBc0QsSUFBQSxDQUtBLE9BSkF6RCxRQUFBQyxlQUFBb0QsUUFDRXJCLEVBQUFzQixTQUFBQyxRQUFBQyxPQUFBLFVBQUF4RCxPQUFBQyxlQUFBb0QsTUFDQUksR0FBQSxHQUVGQSIsImZpbGUiOiJhcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyJhbmd1bGFyLm1vZHVsZSgnYXBwJywgW1xuICAnbmdSb3V0ZSdcbl0pXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb250cm9sbGVyKCdBcHBsaWNhdGlvbkN0cmwnLCBmdW5jdGlvbiAoJHNjb3BlLCAkbG9jYXRpb24sICR3aW5kb3csIFVzZXJTdmMpIHtcbiAgJHNjb3BlLiRvbignbG9naW4nLCBmdW5jdGlvbiAoXywgdXNlcikge1xuICAgICRzY29wZS5jdXJyZW50VXNlciA9IHVzZXJcbiAgICAkbG9jYXRpb24ucGF0aCgnLycpXG4gIH0pXG5cbiAgJHNjb3BlLmxvZ291dCA9IGZ1bmN0aW9uKCl7XG4gIFx0ZGVsZXRlKCRzY29wZS5jdXJyZW50VXNlcikgXG4gICAgJGxvY2F0aW9uLnBhdGgoJy8nKVxuICAgIHdpbmRvdy5zZXNzaW9uU3RvcmFnZS5yZW1vdmVJdGVtKCd0b2tlbicpXG4gIH1cblxuICBpZihVc2VyU3ZjLmlzTG9nZ2VkSW4oKSl7XG5cdCAgXHR2YXIgdXNlciA9IFVzZXJTdmMuZ2V0VXNlcigpLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2Upe1xuXHRcdCAgICAkc2NvcGUuY3VycmVudFVzZXIgPSByZXNwb25zZTtcblx0ICBcdH0pXG4gXHR9XG5cbn0pXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb250cm9sbGVyKCdBc2tDdHJsJywgZnVuY3Rpb24gKCRzY29wZSwgUXVlc3RTdmMpIHtcbiAgJHNjb3BlLmFkZFF1ZXN0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgIGlmICgkc2NvcGUucG9zdEJvZHkpIHtcbiAgICAgIFF1ZXN0U3ZjLmNyZWF0ZSh7XG4gICAgICAgIHVzZXJuYW1lOiAkc2NvcGUuY3VycmVudFVzZXIudXNlcm5hbWUsXG4gICAgICAgIGJvZHk6ICAgICAkc2NvcGUucG9zdEJvZHlcbiAgICAgIH0pXG4gICAgICAuc3VjY2VzcyhmdW5jdGlvbiAocXVlc3Rpb24pIHtcbiAgICAgICAgJHNjb3BlLnF1ZXN0aW9ucy51bnNoaWZ0KHF1ZXN0aW9uKVxuICAgICAgICAkc2NvcGUucG9zdEJvZHkgPSBudWxsXG4gICAgICB9KVxuICAgIH1cbiAgfVxuXG4gIFF1ZXN0U3ZjLmZldGNoKClcbiAgLnN1Y2Nlc3MoZnVuY3Rpb24gKHF1ZXN0aW9ucykge1xuICAgICRzY29wZS5xdWVzdGlvbnMgPSBxdWVzdGlvbnNcbiAgfSlcbn0pIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uY29udHJvbGxlcignTG9naW5DdHJsJywgZnVuY3Rpb24gKCRzY29wZSwgVXNlclN2Yykge1xuICAkc2NvcGUubG9naW4gPSBmdW5jdGlvbiAodXNlcm5hbWUsIHBhc3N3b3JkKSB7XG4gIFx0JHNjb3BlLmVycm9yTXNnID0gJyc7XG4gICAgVXNlclN2Yy5sb2dpbih1c2VybmFtZSwgcGFzc3dvcmQpXG4gICAgLnRoZW4oZnVuY3Rpb24gKHVzZXIpIHtcbiAgICAgICRzY29wZS4kZW1pdCgnbG9naW4nLCB1c2VyKVxuICAgIH0sIGZ1bmN0aW9uKGVycm9yKXtcbiAgICBcdCRzY29wZS5lcnJvck1zZyA9IFwiSW5jb3JyZWN0IHVzZXJuYW1lL3Bhc3N3b3JkLlwiO1xuICAgIH0pXG4gIH1cbn0pXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb250cm9sbGVyKCdRdWVzdEN0cmwnLCBmdW5jdGlvbiAoJHNjb3BlLCBRdWVzdFN2YywgJGxvY2F0aW9uKSB7XG4gICRzY29wZS5hZGRRdWVzdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoJHNjb3BlLnBvc3RCb2R5KSB7XG4gICAgICBRdWVzdFN2Yy5jcmVhdGUoe1xuICAgICAgICB1c2VybmFtZTogJHNjb3BlLmN1cnJlbnRVc2VyLnVzZXJuYW1lLFxuICAgICAgICB0aXRsZTogICAgJHNjb3BlLnRpdGxlLFxuICAgICAgICBib2R5OiAgICAgJHNjb3BlLnBvc3RCb2R5LFxuICAgICAgICBhbnN3ZXJzQ291bnQ6IDAsXG4gICAgICAgIHVwdm90ZTogICAwLFxuICAgICAgICBkb3dudm90ZTogMFxuICAgICAgfSlcbiAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChxdWVzdGlvbikge1xuICAgICAgICAkc2NvcGUucXVlc3Rpb25zLnVuc2hpZnQocXVlc3Rpb24pXG4gICAgICAgICRzY29wZS5wb3N0Qm9keSA9IG51bGxcbiAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy8nKVxuICAgICAgfSlcbiAgICB9XG4gIH1cblxuICAkc2NvcGUuYXNrUXVlc3Rpb25WaWV3ID0gZnVuY3Rpb24oKXtcbiAgICAkbG9jYXRpb24ucGF0aCgnL2FzaycpO1xuICB9XG5cbiAgUXVlc3RTdmMuZmV0Y2goKVxuICAuc3VjY2VzcyhmdW5jdGlvbiAocXVlc3Rpb25zKSB7XG4gICAgJHNjb3BlLnF1ZXN0aW9ucyA9IHF1ZXN0aW9uc1xuICB9KVxuXG4gICRzY29wZS5nZXRRdWVzdGlvbkJ5SWQgPSBmdW5jdGlvbiAoaWQpe1xuICAgIFF1ZXN0U3ZjLmZldGNoQnlJZChpZCkudGhlbihmdW5jdGlvbihyZXNwb25zZSl7XG4gICAgICAkc2NvcGUucXVlc3QgPSByZXNwb25zZTtcbiAgICB9KVxuICB9XG5cbn0pXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5zZXJ2aWNlKCdRdWVzdFN2YycsIGZ1bmN0aW9uICgkaHR0cCkge1xuICB0aGlzLmZldGNoID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvcXVlc3Rpb25zJylcbiAgfVxuICBcbiAgdGhpcy5mZXRjaEJ5SWQgPSBmdW5jdGlvbiAoaWQpIHtcbiAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3F1ZXN0aW9ucy8nICsgaWQpXG4gIH1cblxuICB0aGlzLmNyZWF0ZSA9IGZ1bmN0aW9uIChxdWVzdCkge1xuICAgIHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3F1ZXN0aW9ucycsIHF1ZXN0KVxuICB9XG59KVxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uY29udHJvbGxlcignUmVnaXN0ZXJDdHJsJywgZnVuY3Rpb24gKCRzY29wZSwgVXNlclN2Yykge1xuICAkc2NvcGUucmVnaXN0ZXIgPSBmdW5jdGlvbiAodXNlcm5hbWUsIHBhc3N3b3JkKSB7XG4gICAgVXNlclN2Yy5yZWdpc3Rlcih1c2VybmFtZSwgcGFzc3dvcmQpXG4gICAgLnRoZW4oZnVuY3Rpb24gKHVzZXIpIHtcbiAgICAgICRzY29wZS4kZW1pdCgnbG9naW4nLCB1c2VyKVxuICAgIH0pXG4gIH1cbn0pXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb25maWcoZnVuY3Rpb24gKCRyb3V0ZVByb3ZpZGVyKSB7XG4gICRyb3V0ZVByb3ZpZGVyXG4gIC53aGVuKCcvJywgICAgICAgICB7IGNvbnRyb2xsZXI6ICdRdWVzdEN0cmwnLCB0ZW1wbGF0ZVVybDogJy90ZW1wbGF0ZXMvcXVlc3Rpb25zLmh0bWwnIH0pXG4gIC53aGVuKCcvcmVnaXN0ZXInLCB7IGNvbnRyb2xsZXI6ICdSZWdpc3RlckN0cmwnLCB0ZW1wbGF0ZVVybDogJy90ZW1wbGF0ZXMvcmVnaXN0ZXIuaHRtbCcgfSlcbiAgLndoZW4oJy9sb2dpbicsICAgIHsgY29udHJvbGxlcjogJ0xvZ2luQ3RybCcsIHRlbXBsYXRlVXJsOiAnL3RlbXBsYXRlcy9sb2dpbi5odG1sJyB9KVxuICAud2hlbignL2FzaycsICAgICAgeyBjb250cm9sbGVyOiAnUXVlc3RDdHJsJywgdGVtcGxhdGVVcmw6ICcvdGVtcGxhdGVzL2Fzay5odG1sJyB9KVxuICAud2hlbignL3F1ZXN0aW9ucy86cXVlc3RJZCcsICAgIHsgY29udHJvbGxlcjogJ1NpbmdsZVF1ZXN0Q3RybCcsIHRlbXBsYXRlVXJsOiAnL3RlbXBsYXRlcy9xdWVzdC5odG1sJyB9KVxufSlcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmNvbnRyb2xsZXIoJ1NpbmdsZVF1ZXN0Q3RybCcsIFsnJHNjb3BlJywgJyRyb3V0ZVBhcmFtcycsICdTaW5nbGVRdWVzdFN2YycsICckbG9jYXRpb24nLFxuICBmdW5jdGlvbigkc2NvcGUsICRyb3V0ZVBhcmFtcywgU2luZ2xlUXVlc3RTdmMsICRsb2NhdGlvbikge1xuXG4gICAgU2luZ2xlUXVlc3RTdmMuZmV0Y2hCeUlkKCRyb3V0ZVBhcmFtcy5xdWVzdElkKS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKXtcbiAgICAgICRzY29wZS5xdWVzdCA9IHJlc3BvbnNlLmRhdGE7XG4gICAgfSlcblxuICAgICRzY29wZS5hZGRBbnN3ZXIgPSBmdW5jdGlvbigpe1xuICAgICAgU2luZ2xlUXVlc3RTdmMucG9zdEFuc3dlcihcbiAgICAgIFx0ICB7XG5cdCAgICAgICAgdXNlcm5hbWU6ICRzY29wZS5jdXJyZW50VXNlci51c2VybmFtZSxcblx0ICAgICAgICBxdWVzdGlvbklkOiAkcm91dGVQYXJhbXMucXVlc3RJZCxcblx0ICAgICAgICBib2R5OiAgICAgJHNjb3BlLmFuc3dlckJvZHlcblx0ICAgICAgfVxuICAgICAgXHQpLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2Upe1xuICAgICAgXHRcdC8vcmVsb2FkXG4gICAgICB9KVxuICAgIH1cblxuICAgIFNpbmdsZVF1ZXN0U3ZjLmZldGNoQW5zd2Vycygkcm91dGVQYXJhbXMucXVlc3RJZCkudGhlbihmdW5jdGlvbihyZXNwb25zZSl7XG4gICAgXHQkc2NvcGUuYW5zd2VycyA9IHJlc3BvbnNlLmRhdGE7XG4gICAgfSlcbn1dKSIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLnNlcnZpY2UoJ1NpbmdsZVF1ZXN0U3ZjJywgZnVuY3Rpb24gKCRodHRwKSB7XG5cbiAgdGhpcy5mZXRjaEJ5SWQgPSBmdW5jdGlvbiAoaWQpIHtcbiAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3F1ZXN0aW9ucy8nICsgaWQpXG4gIH1cblxuICB0aGlzLnBvc3RBbnN3ZXIgPSBmdW5jdGlvbihhbnN3ZXIpe1xuICBcdHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3F1ZXN0aW9ucy9hbnN3ZXInLCBhbnN3ZXIpXG4gIH1cblxuICB0aGlzLmZldGNoQW5zd2VycyA9IGZ1bmN0aW9uKGlkKXtcbiAgXHRyZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3F1ZXN0aW9ucy9hbnN3ZXIvJyArIGlkKVxuICB9XG5cbn0pXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5zZXJ2aWNlKCdVc2VyU3ZjJywgZnVuY3Rpb24gKCRodHRwKSB7XG4gIHZhciBzdmMgPSB0aGlzXG4gIHN2Yy5nZXRVc2VyID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvdXNlcnMnKVxuICAgIC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgcmV0dXJuIHJlc3BvbnNlLmRhdGFcbiAgICB9KVxuICB9XG4gIHN2Yy5sb2dpbiA9IGZ1bmN0aW9uICh1c2VybmFtZSwgcGFzc3dvcmQpIHtcbiAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9zZXNzaW9ucycsIHtcbiAgICAgIHVzZXJuYW1lOiB1c2VybmFtZSwgcGFzc3dvcmQ6IHBhc3N3b3JkXG4gICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgIHdpbmRvdy5zZXNzaW9uU3RvcmFnZS50b2tlbiA9IHJlc3BvbnNlLmRhdGFcbiAgICAgICRodHRwLmRlZmF1bHRzLmhlYWRlcnMuY29tbW9uWyd4LWF1dGgnXSA9IHJlc3BvbnNlLmRhdGFcbiAgICAgIHJldHVybiBzdmMuZ2V0VXNlcigpXG4gICAgfSlcbiAgfVxuICBzdmMucmVnaXN0ZXIgPSBmdW5jdGlvbiAodXNlcm5hbWUsIHBhc3N3b3JkKSB7XG4gICAgcmV0dXJuICRodHRwLnBvc3QoJy9hcGkvdXNlcnMnLCB7XG4gICAgICB1c2VybmFtZTogdXNlcm5hbWUsIHBhc3N3b3JkOiBwYXNzd29yZFxuICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHN2Yy5sb2dpbih1c2VybmFtZSwgcGFzc3dvcmQpXG4gICAgfSlcbiAgfVxuICBzdmMuaXNMb2dnZWRJbiA9IGZ1bmN0aW9uICgpe1xuICAgIHZhciByZXN1bHQgPSBmYWxzZTtcbiAgICBpZih3aW5kb3cuc2Vzc2lvblN0b3JhZ2UudG9rZW4pe1xuICAgICAgJGh0dHAuZGVmYXVsdHMuaGVhZGVycy5jb21tb25bJ3gtYXV0aCddID0gd2luZG93LnNlc3Npb25TdG9yYWdlLnRva2VuXG4gICAgICByZXN1bHQgPSB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG59KVxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9