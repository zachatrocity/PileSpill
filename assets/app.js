angular.module("app",["ngRoute"]),angular.module("app",["ngRoute","toastr"]).controller("ApplicationCtrl",["$scope","$location","$window","UserSvc","toastr",function(t,e,n,o){if(t.$on("login",function(n,o){t.currentUser=o,e.path("/")}),t.logout=function(){delete t.currentUser,e.path("/"),window.sessionStorage.removeItem("token")},o.isLoggedIn()){o.getUser().then(function(e){t.currentUser=e})}}]),angular.module("app").controller("AskCtrl",["$scope","QuestSvc",function(t,e){t.addQuestion=function(){t.postBody&&e.create({username:t.currentUser.username,body:t.postBody}).success(function(e){t.questions.unshift(e),t.postBody=null})},e.fetch().success(function(e){t.questions=e})}]),angular.module("app").controller("EditCtrl",["$scope","EditSvc","$location","$routeParams",function(t,e,n,o){e.fetchById(o.ansId).then(function(e){console.log(e.data),t.answer=e.data,t.answerTitle=e.data.title,t.answerBody=e.data.body}),t.saveEdit=function(){e.updateById({id:o.ansId,body:t.answerBody}).then(function(){n.path("/questions/"+t.answer.questionId)})},t.discard=function(){n.path("/questions/"+t.answer.questionId)}}]),angular.module("app").service("EditSvc",["$http",function(t){this.fetchById=function(e){return t.get("/api/questions/edit/"+e)},this.updateById=function(e){return t.put("/api/questions/edit/submit",e)}}]),angular.module("app").controller("LoginCtrl",["$scope","UserSvc",function(t,e){t.login=function(n,o){t.errorMsg="",e.login(n,o).then(function(e){t.$emit("login",e)},function(){t.errorMsg="Incorrect username/password."})}}]),angular.module("app").controller("QuestCtrl",["$scope","QuestSvc","$location","toastr",function(t,e,n,o){t.addQuestion=function(){t.postBody&&e.create({username:t.currentUser.username,title:t.title,body:t.postBody,answersCount:0,votes:0}).success(function(e){t.questions.unshift(e),t.postBody=null,n.path("/")})},t.upvoteQuestion=function(n){t.currentUser?e.up({type:"Question",id:t.questions[n]._id}).then(function(e){t.questions[n]=e.data}):o.error("You must be logged in to vote","Error")},t.downvoteQuestion=function(n){t.currentUser?e.down({type:"Question",id:t.questions[n]._id}).then(function(e){t.questions[n]=e.data}):o.error("You must be logged in to vote","Error")},t.askQuestionView=function(){n.path("/ask")},e.fetch().success(function(e){t.questions=e}),t.getQuestionById=function(n){e.fetchById(n).then(function(e){t.quest=e})}}]),angular.module("app").service("QuestSvc",["$http",function(t){this.fetch=function(){return t.get("/api/questions")},this.fetchById=function(e){return t.get("/api/questions/"+e)},this.create=function(e){return t.post("/api/questions",e)},this.up=function(e){return t.put("/api/questions/up/",e)},this.down=function(e){return t.put("/api/questions/down/",e)}}]),angular.module("app").controller("RegisterCtrl",["$scope","UserSvc",function(t,e){t.register=function(n,o){e.register(n,o).then(function(e){t.$emit("login",e)})}}]),angular.module("app").config(["$routeProvider",function(t){t.when("/",{controller:"QuestCtrl",templateUrl:"/templates/questions.html"}).when("/register",{controller:"RegisterCtrl",templateUrl:"/templates/register.html"}).when("/login",{controller:"LoginCtrl",templateUrl:"/templates/login.html"}).when("/ask",{controller:"QuestCtrl",templateUrl:"/templates/ask.html"}).when("/questions/:questId",{controller:"SingleQuestCtrl",templateUrl:"/templates/quest.html"}).when("/answer/edit/:ansId",{controller:"EditCtrl",templateUrl:"/templates/edit.html"})}]),angular.module("app").controller("SingleQuestCtrl",["$scope","$routeParams","SingleQuestSvc","$location","toastr",function(t,e,n,o,s){n.fetchById(e.questId).then(function(e){t.quest=e.data}),t.answerBody="",t.addAnswer=function(){t.answerBody&&(n.postAnswer({username:t.currentUser.username,questionId:e.questId,body:t.answerBody}).then(function(e){t.answers.push(e.data)}),t.answerBody="")},t.deleteAnswer=function(e){n["delete"]({id:t.answers[e]._id}).then(function(){t.answers.splice(e,1)})},t.upvoteAnswer=function(e){t.currentUser?n.up({type:"Answer",id:t.answers[e]._id}).then(function(n){t.answers[e]=n.data}):s.error("You must be logged in to vote","Error")},t.downvoteAnswer=function(e){t.currentUser?n.down({type:"Answer",id:t.answers[e]._id}).then(function(n){t.answers[e]=n.data}):s.error("You must be logged in to vote","Error")},n.fetchAnswers(e.questId).then(function(e){t.answers=e.data})}]).directive("ngReallyClick",[function(){return{restrict:"A",link:function(t,e,n){e.bind("click",function(){var e=n.ngReallyMessage;e&&confirm(e)&&t.$apply(n.ngReallyClick)})}}}]),angular.module("app").service("SingleQuestSvc",["$http",function(t){this.fetchById=function(e){return t.get("/api/questions/"+e)},this.postAnswer=function(e){return t.post("/api/questions/answer",e)},this.fetchAnswers=function(e){return t.get("/api/questions/answer/"+e)},this.up=function(e){return t.put("/api/questions/up/",e)},this.down=function(e){return t.put("/api/questions/down/",e)},this["delete"]=function(e){return t["delete"]("/api/questions/answer/"+e.id)}}]),angular.module("app").service("UserSvc",["$http",function(t){var e=this;e.getUser=function(){return t.get("/api/users").then(function(t){return t.data})},e.login=function(n,o){return t.post("/api/sessions",{username:n,password:o}).then(function(n){return window.sessionStorage.token=n.data,t.defaults.headers.common["x-auth"]=n.data,e.getUser()})},e.register=function(n,o){return t.post("/api/users",{username:n,password:o}).then(function(){return e.login(n,o)})},e.isLoggedIn=function(){var e=!1;return window.sessionStorage.token&&(t.defaults.headers.common["x-auth"]=window.sessionStorage.token,e=!0),e}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsImFwcGxpY2F0aW9uLmN0cmwuanMiLCJhc2suY3RybC5qcyIsImVkaXQuY3RybC5qcyIsImVkaXQuc3ZjLmpzIiwibG9naW4uY3RybC5qcyIsInF1ZXN0LmN0cmwuanMiLCJxdWVzdC5zdmMuanMiLCJyZWdpc3Rlci5jdHJsLmpzIiwicm91dGVzLmpzIiwic2luZ2xlcXVlc3QuY3RybC5qcyIsInNpbmdsZXF1ZXN0LnN2Yy5qcyIsInVzZXIuc3ZjLmpzIl0sIm5hbWVzIjpbImFuZ3VsYXIiLCJtb2R1bGUiLCJjb250cm9sbGVyIiwiJHNjb3BlIiwiJGxvY2F0aW9uIiwiJHdpbmRvdyIsIlVzZXJTdmMiLCIkb24iLCJfIiwidXNlciIsImN1cnJlbnRVc2VyIiwicGF0aCIsImxvZ291dCIsIndpbmRvdyIsInNlc3Npb25TdG9yYWdlIiwicmVtb3ZlSXRlbSIsImlzTG9nZ2VkSW4iLCJnZXRVc2VyIiwidGhlbiIsInJlc3BvbnNlIiwiUXVlc3RTdmMiLCJhZGRRdWVzdGlvbiIsInBvc3RCb2R5IiwiY3JlYXRlIiwidXNlcm5hbWUiLCJib2R5Iiwic3VjY2VzcyIsInF1ZXN0aW9uIiwicXVlc3Rpb25zIiwidW5zaGlmdCIsImZldGNoIiwiRWRpdFN2YyIsIiRyb3V0ZVBhcmFtcyIsImZldGNoQnlJZCIsImFuc0lkIiwiY29uc29sZSIsImxvZyIsImRhdGEiLCJhbnN3ZXIiLCJhbnN3ZXJUaXRsZSIsInRpdGxlIiwiYW5zd2VyQm9keSIsInNhdmVFZGl0IiwidXBkYXRlQnlJZCIsImlkIiwicXVlc3Rpb25JZCIsImRpc2NhcmQiLCJzZXJ2aWNlIiwiJGh0dHAiLCJ0aGlzIiwiZ2V0Iiwib2JqIiwicHV0IiwibG9naW4iLCJwYXNzd29yZCIsImVycm9yTXNnIiwiJGVtaXQiLCJ0b2FzdHIiLCJhbnN3ZXJzQ291bnQiLCJ2b3RlcyIsInVwdm90ZVF1ZXN0aW9uIiwiaW5kZXgiLCJ1cCIsInR5cGUiLCJfaWQiLCJxdWVzdCIsImVycm9yIiwiZG93bnZvdGVRdWVzdGlvbiIsImRvd24iLCJhc2tRdWVzdGlvblZpZXciLCJnZXRRdWVzdGlvbkJ5SWQiLCJwb3N0IiwicmVnaXN0ZXIiLCJjb25maWciLCIkcm91dGVQcm92aWRlciIsIndoZW4iLCJ0ZW1wbGF0ZVVybCIsIlNpbmdsZVF1ZXN0U3ZjIiwicXVlc3RJZCIsImFkZEFuc3dlciIsInBvc3RBbnN3ZXIiLCJhbnN3ZXJzIiwicHVzaCIsImRlbGV0ZUFuc3dlciIsInNwbGljZSIsInVwdm90ZUFuc3dlciIsImFucyIsImRvd252b3RlQW5zd2VyIiwiZmV0Y2hBbnN3ZXJzIiwiZGlyZWN0aXZlIiwicmVzdHJpY3QiLCJsaW5rIiwic2NvcGUiLCJlbGVtZW50IiwiYXR0cnMiLCJiaW5kIiwibWVzc2FnZSIsIm5nUmVhbGx5TWVzc2FnZSIsImNvbmZpcm0iLCIkYXBwbHkiLCJuZ1JlYWxseUNsaWNrIiwic3ZjIiwidG9rZW4iLCJkZWZhdWx0cyIsImhlYWRlcnMiLCJjb21tb24iLCJyZXN1bHQiXSwibWFwcGluZ3MiOiJBQUFBQSxRQUFBQyxPQUFBLE9BQ0UsWUNERkQsUUFBQUMsT0FBQSxPQUFBLFVBQUEsV0FDQUMsV0FBQSxtQkFBK0IsU0FBQSxZQUFBLFVBQUEsVUFBQSxTQUFBLFNBQUFDLEVBQUFDLEVBQUFDLEVBQUFDLEdBWTdCLEdBWEFILEVBQUFJLElBQUEsUUFBQSxTQUFBQyxFQUFBQyxHQUNFTixFQUFBTyxZQUFBRCxFQUNBTCxFQUFBTyxLQUFBLE9BR0ZSLEVBQUFTLE9BQUEsaUJBQ0NULEdBQUEsWUFDQ0MsRUFBQU8sS0FBQSxLQUNBRSxPQUFBQyxlQUFBQyxXQUFBLFVBR0ZULEVBQUFVLGFBQ0UsQ0FBQVYsRUFBQVcsVUFBQUMsS0FBQSxTQUFBQyxHQUNFaEIsRUFBQU8sWUFBQVMsUUNmTm5CLFFBQUFDLE9BQUEsT0FDQUMsV0FBQSxXQUF1QixTQUFBLFdBQUEsU0FBQUMsRUFBQWlCLEdBQ3JCakIsRUFBQWtCLFlBQUEsV0FDRWxCLEVBQUFtQixVQUNFRixFQUFBRyxRQUNFQyxTQUFB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RixPQUFBQyxlQUFBd0YsTUFDQUksR0FBQSxHQUVGQSIsImZpbGUiOiJhcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyJhbmd1bGFyLm1vZHVsZSgnYXBwJywgW1xuICAnbmdSb3V0ZSdcbl0pXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJywgWyduZ1JvdXRlJywndG9hc3RyJ10pXG4uY29udHJvbGxlcignQXBwbGljYXRpb25DdHJsJywgZnVuY3Rpb24gKCRzY29wZSwgJGxvY2F0aW9uLCAkd2luZG93LCBVc2VyU3ZjLCB0b2FzdHIpIHtcbiAgJHNjb3BlLiRvbignbG9naW4nLCBmdW5jdGlvbiAoXywgdXNlcikge1xuICAgICRzY29wZS5jdXJyZW50VXNlciA9IHVzZXJcbiAgICAkbG9jYXRpb24ucGF0aCgnLycpXG4gIH0pXG5cbiAgJHNjb3BlLmxvZ291dCA9IGZ1bmN0aW9uKCl7XG4gIFx0ZGVsZXRlKCRzY29wZS5jdXJyZW50VXNlcikgXG4gICAgJGxvY2F0aW9uLnBhdGgoJy8nKVxuICAgIHdpbmRvdy5zZXNzaW9uU3RvcmFnZS5yZW1vdmVJdGVtKCd0b2tlbicpXG4gIH1cblxuICBpZihVc2VyU3ZjLmlzTG9nZ2VkSW4oKSl7XG5cdCAgXHR2YXIgdXNlciA9IFVzZXJTdmMuZ2V0VXNlcigpLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2Upe1xuXHRcdCAgICAkc2NvcGUuY3VycmVudFVzZXIgPSByZXNwb25zZTtcblx0ICBcdH0pXG4gXHR9XG5cbn0pXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb250cm9sbGVyKCdBc2tDdHJsJywgZnVuY3Rpb24gKCRzY29wZSwgUXVlc3RTdmMpIHtcbiAgJHNjb3BlLmFkZFF1ZXN0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgIGlmICgkc2NvcGUucG9zdEJvZHkpIHtcbiAgICAgIFF1ZXN0U3ZjLmNyZWF0ZSh7XG4gICAgICAgIHVzZXJuYW1lOiAkc2NvcGUuY3VycmVudFVzZXIudXNlcm5hbWUsXG4gICAgICAgIGJvZHk6ICAgICAkc2NvcGUucG9zdEJvZHlcbiAgICAgIH0pXG4gICAgICAuc3VjY2VzcyhmdW5jdGlvbiAocXVlc3Rpb24pIHtcbiAgICAgICAgJHNjb3BlLnF1ZXN0aW9ucy51bnNoaWZ0KHF1ZXN0aW9uKVxuICAgICAgICAkc2NvcGUucG9zdEJvZHkgPSBudWxsXG4gICAgICB9KVxuICAgIH1cbiAgfVxuXG4gIFF1ZXN0U3ZjLmZldGNoKClcbiAgLnN1Y2Nlc3MoZnVuY3Rpb24gKHF1ZXN0aW9ucykge1xuICAgICRzY29wZS5xdWVzdGlvbnMgPSBxdWVzdGlvbnNcbiAgfSlcbn0pIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uY29udHJvbGxlcignRWRpdEN0cmwnLCBmdW5jdGlvbiAoJHNjb3BlLCBFZGl0U3ZjLCAkbG9jYXRpb24sICRyb3V0ZVBhcmFtcykge1xuXG5cdEVkaXRTdmMuZmV0Y2hCeUlkKCRyb3V0ZVBhcmFtcy5hbnNJZCkudGhlbihmdW5jdGlvbihyZXNwb25zZSl7XG5cdFx0Y29uc29sZS5sb2cocmVzcG9uc2UuZGF0YSlcblx0ICAkc2NvcGUuYW5zd2VyID0gcmVzcG9uc2UuZGF0YTtcbiAgICAgICRzY29wZS5hbnN3ZXJUaXRsZSA9IHJlc3BvbnNlLmRhdGEudGl0bGVcbiAgICAgICRzY29wZS5hbnN3ZXJCb2R5ID0gcmVzcG9uc2UuZGF0YS5ib2R5XG4gICAgfSlcblxuICAgICRzY29wZS5zYXZlRWRpdCA9IGZ1bmN0aW9uKCl7XG4gICAgXHRFZGl0U3ZjLnVwZGF0ZUJ5SWQoe2lkOiAkcm91dGVQYXJhbXMuYW5zSWQsIGJvZHk6ICRzY29wZS5hbnN3ZXJCb2R5fSlcbiAgICBcdC50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKXtcbiAgICBcdFx0JGxvY2F0aW9uLnBhdGgoJy9xdWVzdGlvbnMvJyArICRzY29wZS5hbnN3ZXIucXVlc3Rpb25JZClcbiAgICBcdH0pXG4gICAgfVxuXG4gICAgJHNjb3BlLmRpc2NhcmQgPSBmdW5jdGlvbigpe1xuICAgIFx0JGxvY2F0aW9uLnBhdGgoJy9xdWVzdGlvbnMvJyArICRzY29wZS5hbnN3ZXIucXVlc3Rpb25JZClcbiAgICB9XG5cbn0pIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uc2VydmljZSgnRWRpdFN2YycsIGZ1bmN0aW9uICgkaHR0cCkge1xuXG4gIHRoaXMuZmV0Y2hCeUlkID0gZnVuY3Rpb24gKGlkKSB7XG4gICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS9xdWVzdGlvbnMvZWRpdC8nICsgaWQpXG4gIH1cblxuICB0aGlzLnVwZGF0ZUJ5SWQgPSBmdW5jdGlvbihvYmopIHtcbiAgXHRyZXR1cm4gJGh0dHAucHV0KCcvYXBpL3F1ZXN0aW9ucy9lZGl0L3N1Ym1pdCcsIG9iailcbiAgfVxuXG59KSIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmNvbnRyb2xsZXIoJ0xvZ2luQ3RybCcsIGZ1bmN0aW9uICgkc2NvcGUsIFVzZXJTdmMpIHtcbiAgJHNjb3BlLmxvZ2luID0gZnVuY3Rpb24gKHVzZXJuYW1lLCBwYXNzd29yZCkge1xuICBcdCRzY29wZS5lcnJvck1zZyA9ICcnO1xuICAgIFVzZXJTdmMubG9naW4odXNlcm5hbWUsIHBhc3N3b3JkKVxuICAgIC50aGVuKGZ1bmN0aW9uICh1c2VyKSB7XG4gICAgICAkc2NvcGUuJGVtaXQoJ2xvZ2luJywgdXNlcilcbiAgICB9LCBmdW5jdGlvbihlcnJvcil7XG4gICAgXHQkc2NvcGUuZXJyb3JNc2cgPSBcIkluY29ycmVjdCB1c2VybmFtZS9wYXNzd29yZC5cIjtcbiAgICB9KVxuICB9XG59KVxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uY29udHJvbGxlcignUXVlc3RDdHJsJywgZnVuY3Rpb24gKCRzY29wZSwgUXVlc3RTdmMsICRsb2NhdGlvbiwgdG9hc3RyKSB7XG4gICRzY29wZS5hZGRRdWVzdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoJHNjb3BlLnBvc3RCb2R5KSB7XG4gICAgICBRdWVzdFN2Yy5jcmVhdGUoe1xuICAgICAgICB1c2VybmFtZTogJHNjb3BlLmN1cnJlbnRVc2VyLnVzZXJuYW1lLFxuICAgICAgICB0aXRsZTogICAgJHNjb3BlLnRpdGxlLFxuICAgICAgICBib2R5OiAgICAgJHNjb3BlLnBvc3RCb2R5LFxuICAgICAgICBhbnN3ZXJzQ291bnQ6IDAsXG4gICAgICAgIHZvdGVzOiAgIDBcbiAgICAgIH0pXG4gICAgICAuc3VjY2VzcyhmdW5jdGlvbiAocXVlc3Rpb24pIHtcbiAgICAgICAgJHNjb3BlLnF1ZXN0aW9ucy51bnNoaWZ0KHF1ZXN0aW9uKVxuICAgICAgICAkc2NvcGUucG9zdEJvZHkgPSBudWxsXG4gICAgICAgICRsb2NhdGlvbi5wYXRoKCcvJylcbiAgICAgIH0pXG4gICAgfVxuICB9XG5cbiAgJHNjb3BlLnVwdm90ZVF1ZXN0aW9uID0gZnVuY3Rpb24oaW5kZXgpe1xuICAgIGlmKCRzY29wZS5jdXJyZW50VXNlcil7XG4gICAgICBRdWVzdFN2Yy51cCh7IHR5cGU6IFwiUXVlc3Rpb25cIiwgaWQ6ICRzY29wZS5xdWVzdGlvbnNbaW5kZXhdLl9pZH0pLnRoZW4oZnVuY3Rpb24ocXVlc3Qpe1xuICAgICAgICAkc2NvcGUucXVlc3Rpb25zW2luZGV4XSA9IHF1ZXN0LmRhdGE7XG4gICAgICB9KVxuICAgIH0gZWxzZXtcbiAgICAgIHRvYXN0ci5lcnJvcignWW91IG11c3QgYmUgbG9nZ2VkIGluIHRvIHZvdGUnLCAnRXJyb3InKTtcbiAgICB9XG4gIH1cblxuICAkc2NvcGUuZG93bnZvdGVRdWVzdGlvbiA9IGZ1bmN0aW9uKGluZGV4KXtcbiAgICBpZigkc2NvcGUuY3VycmVudFVzZXIpe1xuICAgICAgUXVlc3RTdmMuZG93bih7IHR5cGU6IFwiUXVlc3Rpb25cIiwgaWQ6ICRzY29wZS5xdWVzdGlvbnNbaW5kZXhdLl9pZH0pLnRoZW4oZnVuY3Rpb24ocXVlc3Qpe1xuICAgICAgICAkc2NvcGUucXVlc3Rpb25zW2luZGV4XSA9IHF1ZXN0LmRhdGE7XG4gICAgICB9KVxuICAgIH1lbHNle1xuICAgICAgdG9hc3RyLmVycm9yKCdZb3UgbXVzdCBiZSBsb2dnZWQgaW4gdG8gdm90ZScsICdFcnJvcicpO1xuICAgIH1cbiAgfVxuXG4gICRzY29wZS5hc2tRdWVzdGlvblZpZXcgPSBmdW5jdGlvbigpe1xuICAgICRsb2NhdGlvbi5wYXRoKCcvYXNrJyk7XG4gIH1cblxuICBRdWVzdFN2Yy5mZXRjaCgpXG4gIC5zdWNjZXNzKGZ1bmN0aW9uIChxdWVzdGlvbnMpIHtcbiAgICAkc2NvcGUucXVlc3Rpb25zID0gcXVlc3Rpb25zXG4gIH0pXG5cbiAgJHNjb3BlLmdldFF1ZXN0aW9uQnlJZCA9IGZ1bmN0aW9uIChpZCl7XG4gICAgUXVlc3RTdmMuZmV0Y2hCeUlkKGlkKS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKXtcbiAgICAgICRzY29wZS5xdWVzdCA9IHJlc3BvbnNlO1xuICAgIH0pXG4gIH1cblxufSlcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLnNlcnZpY2UoJ1F1ZXN0U3ZjJywgZnVuY3Rpb24gKCRodHRwKSB7XG4gIHRoaXMuZmV0Y2ggPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS9xdWVzdGlvbnMnKVxuICB9XG4gIFxuICB0aGlzLmZldGNoQnlJZCA9IGZ1bmN0aW9uIChpZCkge1xuICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvcXVlc3Rpb25zLycgKyBpZClcbiAgfVxuXG4gIHRoaXMuY3JlYXRlID0gZnVuY3Rpb24gKHF1ZXN0KSB7XG4gICAgcmV0dXJuICRodHRwLnBvc3QoJy9hcGkvcXVlc3Rpb25zJywgcXVlc3QpXG4gIH1cblxuICB0aGlzLnVwID0gZnVuY3Rpb24ob2JqKSB7XG4gIFx0cmV0dXJuICRodHRwLnB1dCgnL2FwaS9xdWVzdGlvbnMvdXAvJywgb2JqKVxuICB9XG5cbiAgdGhpcy5kb3duID0gZnVuY3Rpb24ob2JqKSB7XG4gIFx0cmV0dXJuICRodHRwLnB1dCgnL2FwaS9xdWVzdGlvbnMvZG93bi8nLCBvYmopXG4gIH1cbn0pXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb250cm9sbGVyKCdSZWdpc3RlckN0cmwnLCBmdW5jdGlvbiAoJHNjb3BlLCBVc2VyU3ZjKSB7XG4gICRzY29wZS5yZWdpc3RlciA9IGZ1bmN0aW9uICh1c2VybmFtZSwgcGFzc3dvcmQpIHtcbiAgICBVc2VyU3ZjLnJlZ2lzdGVyKHVzZXJuYW1lLCBwYXNzd29yZClcbiAgICAudGhlbihmdW5jdGlvbiAodXNlcikge1xuICAgICAgJHNjb3BlLiRlbWl0KCdsb2dpbicsIHVzZXIpXG4gICAgfSlcbiAgfVxufSlcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmNvbmZpZyhmdW5jdGlvbiAoJHJvdXRlUHJvdmlkZXIpIHtcbiAgJHJvdXRlUHJvdmlkZXJcbiAgLndoZW4oJy8nLCAgICAgICAgIHsgY29udHJvbGxlcjogJ1F1ZXN0Q3RybCcsIHRlbXBsYXRlVXJsOiAnL3RlbXBsYXRlcy9xdWVzdGlvbnMuaHRtbCcgfSlcbiAgLndoZW4oJy9yZWdpc3RlcicsIHsgY29udHJvbGxlcjogJ1JlZ2lzdGVyQ3RybCcsIHRlbXBsYXRlVXJsOiAnL3RlbXBsYXRlcy9yZWdpc3Rlci5odG1sJyB9KVxuICAud2hlbignL2xvZ2luJywgICAgeyBjb250cm9sbGVyOiAnTG9naW5DdHJsJywgdGVtcGxhdGVVcmw6ICcvdGVtcGxhdGVzL2xvZ2luLmh0bWwnIH0pXG4gIC53aGVuKCcvYXNrJywgICAgICB7IGNvbnRyb2xsZXI6ICdRdWVzdEN0cmwnLCB0ZW1wbGF0ZVVybDogJy90ZW1wbGF0ZXMvYXNrLmh0bWwnIH0pXG4gIC53aGVuKCcvcXVlc3Rpb25zLzpxdWVzdElkJywgICAgeyBjb250cm9sbGVyOiAnU2luZ2xlUXVlc3RDdHJsJywgdGVtcGxhdGVVcmw6ICcvdGVtcGxhdGVzL3F1ZXN0Lmh0bWwnIH0pXG4gIC53aGVuKCcvYW5zd2VyL2VkaXQvOmFuc0lkJywgICAgeyBjb250cm9sbGVyOiAnRWRpdEN0cmwnLCB0ZW1wbGF0ZVVybDogJy90ZW1wbGF0ZXMvZWRpdC5odG1sJyB9KVxufSlcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmNvbnRyb2xsZXIoJ1NpbmdsZVF1ZXN0Q3RybCcsIFsnJHNjb3BlJywgJyRyb3V0ZVBhcmFtcycsICdTaW5nbGVRdWVzdFN2YycsICckbG9jYXRpb24nLCAndG9hc3RyJyxcbiAgZnVuY3Rpb24oJHNjb3BlLCAkcm91dGVQYXJhbXMsIFNpbmdsZVF1ZXN0U3ZjLCAkbG9jYXRpb24sIHRvYXN0cikge1xuXG4gICAgU2luZ2xlUXVlc3RTdmMuZmV0Y2hCeUlkKCRyb3V0ZVBhcmFtcy5xdWVzdElkKS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKXtcbiAgICAgICRzY29wZS5xdWVzdCA9IHJlc3BvbnNlLmRhdGE7XG4gICAgfSlcbiAgICBcbiAgICAkc2NvcGUuYW5zd2VyQm9keSA9IFwiXCI7XG5cbiAgICAkc2NvcGUuYWRkQW5zd2VyID0gZnVuY3Rpb24oKXtcbiAgICAgIGlmKCRzY29wZS5hbnN3ZXJCb2R5KXtcblx0ICAgICAgU2luZ2xlUXVlc3RTdmMucG9zdEFuc3dlcihcblx0ICAgICAgXHQgIHtcblx0XHQgICAgICAgIHVzZXJuYW1lOiAkc2NvcGUuY3VycmVudFVzZXIudXNlcm5hbWUsXG5cdFx0ICAgICAgICBxdWVzdGlvbklkOiAkcm91dGVQYXJhbXMucXVlc3RJZCxcblx0XHQgICAgICAgIGJvZHk6ICAgICAkc2NvcGUuYW5zd2VyQm9keVxuXHRcdCAgICAgIH1cblx0ICAgICAgXHQpLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2Upe1xuXHQgICAgICBcdFx0Ly9yZWxvYWRcblx0ICAgICAgXHRcdCRzY29wZS5hbnN3ZXJzLnB1c2gocmVzcG9uc2UuZGF0YSlcblx0ICAgICAgfSlcblxuXHQgICAgICBcdCRzY29wZS5hbnN3ZXJCb2R5ID0gXCJcIlxuICAgICAgfVxuICAgIH1cblxuICAgICRzY29wZS5kZWxldGVBbnN3ZXIgPSBmdW5jdGlvbihpbmRleCl7XG4gICAgXHRTaW5nbGVRdWVzdFN2Yy5kZWxldGUoe2lkOiAkc2NvcGUuYW5zd2Vyc1tpbmRleF0uX2lkfSkudGhlbihmdW5jdGlvbihyZXMpe1xuICAgIFx0XHQkc2NvcGUuYW5zd2Vycy5zcGxpY2UoaW5kZXgsIDEpO1xuXHQgICAgfSlcbiAgICB9XG5cbiAgICAkc2NvcGUudXB2b3RlQW5zd2VyID0gZnVuY3Rpb24oaW5kZXgpe1xuICAgIFx0aWYoJHNjb3BlLmN1cnJlbnRVc2VyKXtcblx0XHQgICAgU2luZ2xlUXVlc3RTdmMudXAoeyB0eXBlOiBcIkFuc3dlclwiLCBpZDogJHNjb3BlLmFuc3dlcnNbaW5kZXhdLl9pZH0pLnRoZW4oZnVuY3Rpb24oYW5zKXtcblx0XHQgICAgICAkc2NvcGUuYW5zd2Vyc1tpbmRleF0gPSBhbnMuZGF0YTtcblx0XHQgICAgfSlcblx0XHR9IGVsc2V7XG5cdFx0XHR0b2FzdHIuZXJyb3IoJ1lvdSBtdXN0IGJlIGxvZ2dlZCBpbiB0byB2b3RlJywgJ0Vycm9yJyk7XG5cdFx0fVxuXHQgIH1cblxuXHQkc2NvcGUuZG93bnZvdGVBbnN3ZXIgPSBmdW5jdGlvbihpbmRleCl7XG5cdFx0aWYoJHNjb3BlLmN1cnJlbnRVc2VyKXtcblx0XHQgICAgU2luZ2xlUXVlc3RTdmMuZG93bih7dHlwZTogXCJBbnN3ZXJcIiwgaWQ6ICRzY29wZS5hbnN3ZXJzW2luZGV4XS5faWR9KS50aGVuKGZ1bmN0aW9uKGFucyl7XG5cdFx0ICAgICAgJHNjb3BlLmFuc3dlcnNbaW5kZXhdID0gYW5zLmRhdGE7XG5cdFx0ICAgIH0pXG5cdFx0fWVsc2V7XG5cdFx0XHR0b2FzdHIuZXJyb3IoJ1lvdSBtdXN0IGJlIGxvZ2dlZCBpbiB0byB2b3RlJywgJ0Vycm9yJyk7XG5cdFx0fVxuXHQgIH1cblxuICAgIFNpbmdsZVF1ZXN0U3ZjLmZldGNoQW5zd2Vycygkcm91dGVQYXJhbXMucXVlc3RJZCkudGhlbihmdW5jdGlvbihyZXNwb25zZSl7XG4gICAgXHQkc2NvcGUuYW5zd2VycyA9IHJlc3BvbnNlLmRhdGE7XG4gICAgfSlcbn1dKVxuLyoqXG4gKiBBIGdlbmVyaWMgY29uZmlybWF0aW9uIGZvciByaXNreSBhY3Rpb25zLlxuICogVXNhZ2U6IEFkZCBhdHRyaWJ1dGVzOiBuZy1yZWFsbHktbWVzc2FnZT1cIkFyZSB5b3Ugc3VyZVwiPyBuZy1yZWFsbHktY2xpY2s9XCJ0YWtlQWN0aW9uKClcIiBmdW5jdGlvblxuICovXG4uZGlyZWN0aXZlKCduZ1JlYWxseUNsaWNrJywgW2Z1bmN0aW9uKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRycykge1xuICAgICAgICAgICAgZWxlbWVudC5iaW5kKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlID0gYXR0cnMubmdSZWFsbHlNZXNzYWdlO1xuICAgICAgICAgICAgICAgIGlmIChtZXNzYWdlICYmIGNvbmZpcm0obWVzc2FnZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuJGFwcGx5KGF0dHJzLm5nUmVhbGx5Q2xpY2spO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxufV0pOyIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLnNlcnZpY2UoJ1NpbmdsZVF1ZXN0U3ZjJywgZnVuY3Rpb24gKCRodHRwKSB7XG5cbiAgdGhpcy5mZXRjaEJ5SWQgPSBmdW5jdGlvbiAoaWQpIHtcbiAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3F1ZXN0aW9ucy8nICsgaWQpXG4gIH1cblxuICB0aGlzLnBvc3RBbnN3ZXIgPSBmdW5jdGlvbihhbnN3ZXIpe1xuICBcdHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3F1ZXN0aW9ucy9hbnN3ZXInLCBhbnN3ZXIpXG4gIH1cblxuICB0aGlzLmZldGNoQW5zd2VycyA9IGZ1bmN0aW9uKGlkKXtcbiAgXHRyZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3F1ZXN0aW9ucy9hbnN3ZXIvJyArIGlkKVxuICB9XG5cbiAgdGhpcy51cCA9IGZ1bmN0aW9uKG9iaikge1xuICBcdHJldHVybiAkaHR0cC5wdXQoJy9hcGkvcXVlc3Rpb25zL3VwLycsIG9iailcbiAgfVxuXG4gIHRoaXMuZG93biA9IGZ1bmN0aW9uKG9iaikge1xuICBcdHJldHVybiAkaHR0cC5wdXQoJy9hcGkvcXVlc3Rpb25zL2Rvd24vJywgb2JqKVxuICB9XG5cbiAgdGhpcy5kZWxldGUgPSBmdW5jdGlvbihvYmope1xuICAgIHJldHVybiAkaHR0cC5kZWxldGUoJy9hcGkvcXVlc3Rpb25zL2Fuc3dlci8nICsgb2JqLmlkKVxuICB9XG5cbn0pXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5zZXJ2aWNlKCdVc2VyU3ZjJywgZnVuY3Rpb24gKCRodHRwKSB7XG4gIHZhciBzdmMgPSB0aGlzXG4gIHN2Yy5nZXRVc2VyID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvdXNlcnMnKVxuICAgIC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgcmV0dXJuIHJlc3BvbnNlLmRhdGFcbiAgICB9KVxuICB9XG4gIHN2Yy5sb2dpbiA9IGZ1bmN0aW9uICh1c2VybmFtZSwgcGFzc3dvcmQpIHtcbiAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9zZXNzaW9ucycsIHtcbiAgICAgIHVzZXJuYW1lOiB1c2VybmFtZSwgcGFzc3dvcmQ6IHBhc3N3b3JkXG4gICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgIHdpbmRvdy5zZXNzaW9uU3RvcmFnZS50b2tlbiA9IHJlc3BvbnNlLmRhdGFcbiAgICAgICRodHRwLmRlZmF1bHRzLmhlYWRlcnMuY29tbW9uWyd4LWF1dGgnXSA9IHJlc3BvbnNlLmRhdGFcbiAgICAgIHJldHVybiBzdmMuZ2V0VXNlcigpXG4gICAgfSlcbiAgfVxuICBzdmMucmVnaXN0ZXIgPSBmdW5jdGlvbiAodXNlcm5hbWUsIHBhc3N3b3JkKSB7XG4gICAgcmV0dXJuICRodHRwLnBvc3QoJy9hcGkvdXNlcnMnLCB7XG4gICAgICB1c2VybmFtZTogdXNlcm5hbWUsIHBhc3N3b3JkOiBwYXNzd29yZFxuICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHN2Yy5sb2dpbih1c2VybmFtZSwgcGFzc3dvcmQpXG4gICAgfSlcbiAgfVxuICBzdmMuaXNMb2dnZWRJbiA9IGZ1bmN0aW9uICgpe1xuICAgIHZhciByZXN1bHQgPSBmYWxzZTtcbiAgICBpZih3aW5kb3cuc2Vzc2lvblN0b3JhZ2UudG9rZW4pe1xuICAgICAgJGh0dHAuZGVmYXVsdHMuaGVhZGVycy5jb21tb25bJ3gtYXV0aCddID0gd2luZG93LnNlc3Npb25TdG9yYWdlLnRva2VuXG4gICAgICByZXN1bHQgPSB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG59KVxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9